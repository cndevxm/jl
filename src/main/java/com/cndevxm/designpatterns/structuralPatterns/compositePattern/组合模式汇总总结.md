### 组合模式	学习难度：★★★☆☆，使用频率：★★★★☆ 

***

* 前言

  树形结构是我们日常开发中经常遇到到问题，而如何正常得处理叶子节点与容器节点一直是一个问题，而组合模式正是处理树形结构的解决方案，这里实际上我们可以思考一下，如何同样的去处理叶子节点和容器节点，实际上让他们继承同样的类或者实现同样的接口，并提供对子节点的处理能力即可。

* 定义

  组合多个对象形成树形结构以表示“整体-部分”的关系的层次结构。组合模式对叶子节点和容器节点的处理具有一致性，又称为整体-部分模式，是一种对象机构型模式。

* UML

  ![组合模式结构图](.\组合模式结构图.jpg)

* 角色与过程

  * 组合模式共分为三种角色：
    * Component(抽象构件)：叶子构件与容器构件共同继承的父类或者是共同实现的接口，该角色中包含所有子类共有方法的声明和实现，在抽象构件中定义了管理子构件的方法，新增构件、删除构件、获取构件。
    * Leaf(叶子构件)：表示叶子节点，没有子节点，对于继承父类的管理子节点的方法以抛出异常的方式处理。
    * Composite(容器构件)：表示容器节点，包含子节点，子节点可以是容器节点也可以是叶子节点，其提供一个集合来对子节点进行维护，以迭代的方式对子节点进行处理。
  * 组合模式的关键是抽象构件类，它既可以表示叶子节点也可以表示容器节点，对于客户端而言是统一对抽象构件进行处理的，抽象构件类和容器构件类是聚合关联的关系，抽象构件类是容器构件类的一部分，这样容器构件类对子构件进行处理时不用区分是叶子节点还是容器节点，能够统一的做处理。

* 透明组合模式

  ![透明组合模式结构图](.\透明组合模式结构图.png)

  透明组合模式：组合模式标准模式，叶子构件实现子节点管理方法，与容器构件保持一致，但是要进行异常处理（获取不到子节点）。

* 安全组合模式

  ![安全组合模式结构图](.\安全组合模式结构图.jpg)

  安全组合模式：抽象构件与叶子构件保持一致，只包含业务方法，容器构件除包含业务方法外也包含管理子节点的相关代码，在实际代码编写中，将容器构件区别对待。

* 优点
  清楚定义分层次的复杂对象，并且方便对整个层次进行控制，符合开闭原则，对树形结构的处理提供了一种灵活的解决方案。

* 缺点
  新增构件时，很难对容器中的构件类型进行限制。

* 适用场景

  树形结构

  

